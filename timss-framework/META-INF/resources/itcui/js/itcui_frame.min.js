var privMapping=window.privMapping||_parent().privMapping||null;var itcui=itcui||{};itcui.combo_displayed=false;function ITC_GetAbsPos(e){var f=$(e);var b=f.offset().left;var a=f.offset().top;while(f.attr("parentNode")){f=f.parent();b+=f.offset().left;a+=f.offset().top}var d={left:b,top:a};return d}function _parent(){if(typeof(window)=="undefined"){FW.debug("window未定义，为什么？在IE下调调看，是不是又执行了已释放的代码");return null}if(window._xssEmbbed||!window.parent||window.parent.document==document){return window}else{return window.parent}}function ITC_Len(e){var a=e.length;var b=0;for(var d=0;d<a;d++){if(e.charCodeAt(d)<27||e.charCodeAt(d)>126){b+=2}else{b++}}return b}function ITC_Substr(g,h,f){var e=0;c=0;a=0;rstr="";var d=g.length;var b=ITC_Len(g);if(h<0){h=b+h}if(f<1){f=b+f}for(e=0;e<d;e++){if(c>=h){break}var a=g.charCodeAt(e);if(a<127){c+=1}else{c+=2}}for(e=e;e<d;e++){var a=g.charCodeAt(e);if(a<127){c+=1}else{c+=2}rstr+=g.charAt(e);if(c>=f){break}}return rstr}function isArray(a){return Object.prototype.toString.call(a)==="[object Array]"}function priv(a){if(!privMapping){return}$("div,span,button").each(function(){var d=$(this);var b=d.attr("privilege");if(b){if(!privMapping[b]){if(!a){d.css("display","none")}else{d.remove()}}}})}Date.prototype.format=function(b){var d={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(b)){b=b.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var a in d){if(new RegExp("("+a+")").test(b)){b=b.replace(RegExp.$1,RegExp.$1.length==1?d[a]:("00"+d[a]).substr((""+d[a]).length))}}return b};var privMapping=privMapping||null;var _ITC=_ITC||_parent().window._ITC||{};var TREE_HALF_WIDTH=20;var firstHideHint=true;_ITC.navTab=_ITC.navTab||null;_ITC.navTree=_ITC.navTree||null;_ITC.container=_ITC.container||null;_ITC.specTreeState={};_ITC.isTreeButtonShow=false;_ITC.isButtonMouseOut=true;_ITC.isTreeMouseOut=true;_ITC.switchTab=function(a){_ITC.opts.tabSwitchFunc(a)};_ITC._switchTab=function(d,n){var a=_ITC.opts;var h=null;if(!a.tabMapping){return}var b=a.tabMapping[d];if(!b){return}if(b.tab){_ITC._switchTab(b.tab,d);_ITC.useSameTree=b.tab;_ITC.container.switchTo(d,b.url,{cache:true,id:b.id});return}else{_ITC.useSameTree=null}if(_ITC.navTree){if(!_ITC.currTab){_ITC.currTab=d}else{h=_ITC.currTab;_ITC.currTab=d;_ITC.tabTreeStat[h]=_ITC.navTree.ITCUI_NavTree("getstate")}}if(b.tree){_ITC.noTree=false;_ITC.navTree=$("#"+a.treeId).ITCUI_NavTree("init",b.tree,{expandOnlyOne:true});$("#"+a.treeId).click(function(){if($(this).hasClass("tree-dark")){_ITC.mannalHideTree()}});$("#"+_ITC.opts.treeId).show();$("#"+_ITC.opts.bottomId).addClass("tree-width-p")}else{_ITC.noTree=true;$("#"+_ITC.opts.treeId).hide();$("#"+_ITC.opts.bottomId).removeClass("tree-width-p")}if(_ITC.initedTab[d]){_ITC.container.switchTo(d,"",{cache:true})}else{var e={cache:true};_ITC.initedTab[d]=true;if(a.tabMapping[d].id){e.id=a.tabMapping[d].id}if(b.tree){var o=true;for(var l=0;l<b.tree.length;l++){if(!o){break}var f=b.tree[l];if(!privMapping||!f.privilege||privMapping[f.privilege]){if(!f.id&&f.items){for(var k=0;k<f.items.length;k++){var m=f.items[k];if(!privMapping||!m.privilege||privMapping[m.privilege]){_ITC.container.switchTo(d,a.treeMapping[m.id],e);_ITC.navTree.ITCUI_NavTree("highlight",m.id);o=false;break}}}else{if(f.id){_ITC.container.switchTo(d,a.treeMapping[f.id],e);_ITC.navTree.ITCUI_NavTree("highlight",f.id);o=false;break}}}}}else{if(b.url){_ITC.container.switchTo(d,b.url,e)}}}_ITC.adjustFrame();if(_ITC.tabTreeStat[d]){_ITC.navTree.ITCUI_NavTree("loadstate",_ITC.tabTreeStat[d])}if(!_ITC.noTree){var g=n||d;if(_ITC.opts.treeDisplayState=="ALWAYS_OFF"||_ITC.specTreeState[g]=="fold"){_ITC.halfDisplayTree(true,true)}else{_ITC.halfDisplayTree(false,true)}}FW.triggerEvent("onAfterTabSwitch")};_ITC.toggleNavTree=function(a){_ITC.specTreeState[_ITC.navTab.getCurrentTab()]=a;if(a=="fold"){_ITC.halfDisplayTree(true)}else{if(a=="expand"){_ITC.halfDisplayTree(false)}}};_ITC.switchTreeItem=function(a){_ITC.opts.treeSwitchFunc(a)};_ITC._switchTreeItem=function(b){var a=_ITC.opts;if(!a.treeMapping){return}if(_ITC.useSameTree){_ITC.navTab.activeById(_ITC.useSameTree);_ITC.useSameTree=null;_ITC.navTree.switchTo(b);return}_ITC.container.navigate(a.treeMapping[b])};_ITC.addTab=function(d,b){var a=_ITC.opts;if(d==null){return}if(!d.id||!d.name){return}b=b||{};b.cache=b.cache||false;if(!a.tabMapping[d.id]){a.tabMapping[d.id]=b;_ITC.navTab.insert(d)}};_ITC.addTabWithTree=function(a){var e=a.tabOpt||{};var d=_ITC.opts;e.id=a.id;e.name=a.name;var b={tab:a.tab||_ITC.navTab.getCurrentTab(),url:a.url,id:a.id};if(!d.tabMapping[a.id]){d.tabMapping[a.id]=b;_ITC.navTab.insert(e);_ITC.navTab.activeById(a.id)}};_ITC.deleteTab=function(b){var a=_ITC.opts;delete (a.tabMapping[b]);_ITC.container.remove(b);delete (_ITC.initedTab[b]);delete (_ITC.specTreeState[b])};_ITC.init=function(a){if(!_event_handler){FW.debug("没有找到_event_handler,ITC前端框架初始化失败");return}a=a||{};a.tabId=a.tabId||"itcui_nav_tab_container";a.bottomId=a.bottomId||"mainframe_bottom";a.contentId=a.contentId||"mainframe_content";a.treeId=a.treeId||"mainframe_navtree";$("#mainframe_bottom").append("<div class='tree-button-div tree-btn-left' id='btn_treefold' onclick='_ITC.mannalHideTree()'><div class='tree-hide-button'></div></div>");a.tabs=a.tabs||null;a.tabMapping=a.tabMapping||null;a.tabSwitchFunc=a.tabSwitchFunc||_ITC._switchTab;a.treeWidth=$("#"+a.treeId).width()+1;a.treeSwitchFunc=a.treeSwitchFunc||_ITC._switchTreeItem;a.treeDisplayState="AUTO";_ITC.opts=a;_ITC.noTree=false;_ITC.treeState=1;_ITC.initedTab={};_ITC.currTab=null;_ITC.tabTreeStat={};if(a.tabs){_ITC.navTab=new ITCUI_Navigation("#"+a.tabId,a.tabs,{});_ITC.navTab.init()}_ITC.container=new ITCUI_Container("#"+a.contentId);_event_handler.registerEvent("tabSwitch",_ITC.switchTab);_event_handler.registerEvent("navTreeItemClick",_ITC.switchTreeItem);_ITC.adjustFrame();$(window).resize(function(){_ITC.adjustFrame()});_ITC.sideFrameOpts={};FW.registerEvent("onAfterTabSwitch",function(b){_ITC.ctrlSideFrame()});FW.registerEvent("navTreeItemClick",function(b){_ITC.ctrlSideFrame()});$("#mainframe_navtree").mouseover(function(b){b.stopPropagation();if(!_ITC.isTreeButtonShow){_ITC.isTreeButtonShow=true;$("#btn_treefold").show()}_ITC.isTreeMouseOut=false});$("#btn_treefold").mouseover(function(b){b.stopPropagation();_ITC.isButtonMouseOut=false});$("#mainframe_navtree").mouseout(function(){_ITC.isTreeMouseOut=true;_ITC.tryHideTreeButton()});$("#btn_treefold").mouseout(function(){_ITC.isButtonMouseOut=true;_ITC.tryHideTreeButton()})};_ITC.ctrlSideFrame=function(){$(".sideAppendFrame").hide();$("#mainframe_content").attr("class","");var a=_ITC.navTab.getCurrentTab();var e=_ITC.navTree.ITCUI_NavTree("getactive");for(var f in _ITC.sideFrameOpts){var d=_ITC.sideFrameOpts[f];if(d&&d.conditions&&isArray(d.conditions)){for(var g=0;g<d.conditions.length;g++){var h=false;var l=false;var j=d.conditions[g];if(j.tree){var b=new RegExp(j.tree);if(b.test(e)){l=true}}else{l=true}if(j.tab){var b=new RegExp(j.tab);if(b.test(a)){h=true}}else{h=true}if(l&&h){$("#"+d.id).show();$("#mainframe_content").addClass(d.containerCls);break}}}}};var _hideHandle=null;_ITC.tryHideTreeButton=function(){if(_ITC.isTreeButtonShow==false||$("#btn_treefold").hasClass("tree-btn-right")){return}_hideHandle=setTimeout(function(){if(_ITC.isTreeMouseOut&&_ITC.isButtonMouseOut){$("#btn_treefold").hide();_ITC.isTreeButtonShow=false}},150)};_ITC.switchDefaultTab=function(){var d=_ITC.opts;for(var b=0;b<d.tabs.length;b++){var a=d.tabs[b].id;if(!privMapping||privMapping[d.tabMapping[a].privilege]){_ITC.navTab.activeById(a);return}}};_ITC.mannalHideTree=function(){var a=$("#btn_treefold").hasClass("tree-btn-right");if(a){_ITC.opts.treeDisplayState="ALWAYS_ON";_ITC.halfDisplayTree(false,true)}else{_ITC.opts.treeDisplayState="ALWAYS_OFF";_ITC.halfDisplayTree(true,true)}};_ITC._halfDisplayTree=function(a){if(a){$("#btn_treefold").addClass("tree-btn-right").removeClass("tree-btn-left").attr("title","单击展开导航菜单").css("left","19px");$("#"+_ITC.opts.treeId).children(".itc_navtree").addClass("half-hide");$("#"+_ITC.opts.bottomId).addClass("tree-width-p").addClass("tree-half-p");$("#btn_treefold").show()}else{$("#btn_treefold").removeClass("tree-btn-right").addClass("tree-btn-left").attr("title","单击收起导航菜单").css("left","199px");$("#"+_ITC.opts.treeId).children(".itc_navtree").removeClass("half-hide");$("#"+_ITC.opts.bottomId).addClass("tree-width-p").removeClass("tree-half-p")}};_ITC.halfDisplayTree=function(b,a){if(_ITC.noTree){return}if(b){$("#"+_ITC.opts.treeId).css({width:TREE_HALF_WIDTH+"px"});_ITC._halfDisplayTree(b)}else{$("#"+_ITC.opts.treeId).css({width:_ITC.opts.treeWidth+"px"});_ITC._halfDisplayTree(b)}};var lastAdjustTime=0;_ITC.adjustFrame=function(){var b=new Date().getTime();if(b-lastAdjustTime>200){lastAdjustTime=b}else{return}var d=parseInt(document.documentElement.clientWidth);if(_ITC.opts.treeDisplayState=="AUTO"){var a=$("#itc_navtree").hasClass("half-hide");if(d<1000){if(!a){_ITC.halfDisplayTree(true)}}else{if(a){_ITC.halfDisplayTree(false)}}}};_ITC.addSideFrame=function(a){if(!a.src){FW.debug("参数src缺失，必须指定附加iframe的url地址");return}if(!a.conditions){FW.debug("参数conditions缺失，至少应该指定显示在哪些选项卡下，这是一个list");return}a.id=a.id||_ITC.navTab.getCurrentTab();if(_ITC.sideFrameOpts[a.id]){return}a.containerCls=a.containerCls||"pleft230";a.frameCss=a.frameCss||{width:"230px",height:"100%",position:"absolute",display:"block",top:"0px",left:"0px"};_ITC.sideFrameOpts[a.id]=a;var b=_parent().$("#"+_ITC.opts.contentId);b.addClass(a.containerCls);$("<iframe id='"+a.id+"' frameborder='no' border='0' class='sideAppendFrame tree-border-right'></iframe>").prependTo(b).css(a.frameCss).attr("src",a.src)};_ITC.showSkinPage=function(){var b={name:"更换皮肤",id:"changeSkin",afterClose:function(d){_ITC.deleteTab(d);_ITC.navTab.activeById(FW.getCurrentTab())}};var a={url:"../skin/skin.html"};_ITC.addTab(b,a)};function ITCUI_Container(a){var d=a;var e={};var b=null;this.switchTo=function(j,g,f){var i=$(d).children(".ITCUI_Iframe_"+b);if(e[b]){if(e[b].cache){i.css("display","none")}else{i.remove();delete (e[b])}}b=j;if(e[j]&&e[j].cache){$(d).children(".ITCUI_Iframe_"+j).css("display","block")}else{var h="";if(f.id){h=" id='"+f.id+"' "}$("<iframe frameborder='no'"+h+" border='0' style='width:99.7%;height:100%;' class='ITCUI_ContainerFrame ITCUI_Iframe_"+j+"' src='about:blank'></iframe>").appendTo(a);e[j]=f;$(a).children(".ITCUI_Iframe_"+j).attr("src",g)}};this.navigate=function(f){if(b!=null){FW.triggerEvent("onContainerNavigate");var g=$(d).children(".ITCUI_Iframe_"+b);g.attr("src","about:blank");g.attr("src",f)}};this.resize=function(){};this.remove=function(f){delete (e[f]);$(d).children(".ITCUI_Iframe_"+f).remove()}}ITCUI_EventHandler=function(){var a={};var e={};var b={};var d={};this.get=function(f){return b[f]};this.set=function(f,h,g){if(g){b[f]=JSON.parse(JSON.stringify(h))}else{b[f]=h}};this.registerEvent=function(j,k,i){var g=a[j];if(!g){a[j]=[];g=a[j]}var l=(new Date().getTime()%100000)+""+Math.abs(Math.round(Math.random()*1000));g.push([k,l]);e[l]=j;if(i){var h=FW.getCurrentTabId();if(!d[h]){d[h]=[]}d[h].push(l)}return l};this.unregisterEvent=function(n){var m=e[n];if(!m){return}var g=a[m];if(!g){return}var k=0;for(k=0;k<g.length;k++){var f=g[k];if(f[1]==n){break}}var l=[];for(var h=0;h<g.length;h++){if(h!=k){l.push(g[k])}}g=l;delete (e[n])};this.triggerEvent=function(l,j){var g=a[l];var h=[];if(g){for(var k=0;k<g.length;k++){var f=g[k];if(f&&f[0]){h.push(f[0](j))}}}if(h.length>0){return h}return -1}};var _event_handler=window._event_handler||_parent()._event_handler||new ITCUI_EventHandler();(function(a){a.fn.extend({ITCUI_NavTree:function(g,f,d){var j=200;var b="itc_navtree";var i=a(this);var e=this;var h=true;e.initTree=function(q,k){a("#"+b).remove();var u='<div class="itc_navtree" id="'+b+'">';for(var o=0;o<q.length;o++){treeGroup=q[o];var t=b+"_"+o;if(privMapping&&_ITC&&_ITC.opts&&treeGroup.privilege){if(!privMapping[treeGroup.privilege]){continue}}var n=treeGroup.grouptitle||treeGroup.title;if(!treeGroup.items){u+='<div class="itc_navtree_nochildren" id="'+treeGroup.id+'">'+n+"</div>";continue}var l="";if(treeGroup.initexpand){l=" itc_navtree_grouptitle_expand"}u+='<div class="itc_navtree_grouptitle'+l+'" id="'+t+'"><div class="navtree-arrow"></div>'+n+"</div>";var r=t+"_subitem";u+='<div id="'+r+'" class="navtree_subitem"';if(!treeGroup.initexpand){u+=' style="display:none"'}else{i.data("expandedNode",t)}u+=">";if(treeGroup.items){for(var p=0;p<treeGroup.items.length;p++){var m=treeGroup.items[p];if(privMapping&&_ITC&&_ITC.opts){if(!privMapping[m.privilege]){continue}}var s=m.id||b+"_item_"+o+"_"+p;u+='<div class="itc_navtree_item" id="'+s+'">';u+=m.title+"</div>"}}u+="</div>"}u+="</div>";i.append(u)};e.canTreeSwitch=function(m){if(_event_handler){var l=_event_handler.triggerEvent("navTreeItemBeforeClick",m);for(var k=0;k<l.length;k++){if(l[k]===false){return false}}}return true};e.addEvents=function(l,k){a("#"+b).find(".itc_navtree_item,.itc_navtree_nochildren").click(function(){var m=a(this);if(!e.canTreeSwitch(this.id)){return}m.parents(".itc_navtree").find(".itc_navtree_item_selected").removeClass("itc_navtree_item_selected");m.addClass("itc_navtree_item_selected");if(_event_handler){_event_handler.triggerEvent("navTreeItemClick",this.id)}});a("#"+b+" .itc_navtree_grouptitle").click(function(){e.expandNode(this)})};e.expandNode=function(o){var n=a(o).attr("id");var k=n+"_subitem";var m=a("#"+k).css("display")=="none"?true:false;var l=a(o).parents(".itc_navtree");if(h){l.find(".itc_navtree_grouptitle_expand").each(function(){if(l.attr("id")!=n){a(this).removeClass("itc_navtree_grouptitle_expand");a(this).next(".navtree_subitem").hide()}})}if(m){a("#"+k).slideDown();a(o).addClass("itc_navtree_grouptitle_expand")}else{a("#"+k).slideUp();a(o).removeClass("itc_navtree_grouptitle_expand")}};e.switchTo=function(k){if(!e.canTreeSwitch(k)){return}e.highlight(k);if(_event_handler){_event_handler.triggerEvent("navTreeItemClick",k)}};e.highlight=function(p,m){var k=a("#"+b);k.find(".itc_navtree_item_selected").removeClass("itc_navtree_item_selected");var n=k.find("#"+p);n.addClass("itc_navtree_item_selected");if(!m){var l=n.parent();if(l.hasClass("navtree_subitem")){var o=l.prev(".itc_navtree_grouptitle");if(!o.hasClass("itc_navtree_grouptitle_expand")){e.expandNode(o)}}}};e.getTreeState=function(){var n={};var m=i.find(".itc_navtree_grouptitle");for(var q=0;q<m.length;q++){var s=a(m[q]);n[s.attr("id")]={items:{}};if(s.hasClass("itc_navtree_grouptitle_expand")){n[s.attr("id")]["expanded"]=true;var l=s.next(".navtree_subitem").find(".itc_navtree_item");for(var p=0;p<l.length;p++){var k=a(l[p]);if(k.hasClass("itc_navtree_item_selected")){n[s.attr("id")]["items"][k.attr("id")]={selected:true}}}}}var r=i.find(".itc_navtree_nochildren");for(var q=0;q<r.length;q++){var s=a(r[q]);if(s.hasClass("itc_navtree_item_selected")){n[s.attr("id")]={selected:true}}}return n};e.loadTreeState=function(m){for(var l in m){var p=a("#"+l);if(m[l].expanded){p.addClass("itc_navtree_grouptitle_expand");p.next(".navtree_subitem").show()}else{p.removeClass("itc_navtree_grouptitle_expand");p.next(".navtree_subitem").hide()}if(m[l].selected){p.addClass("itc_navtree_item_selected")}if(m[l].items){for(var n in m[l].items){var p=m[l].items[n];if(p.selected){a("#"+n).addClass("itc_navtree_item_selected")}}}}};e.getActiveItemId=function(){return i.find(".itc_navtree_item_selected").attr("id")};if(g=="init"){if(d){if(d.width&&d.width>100){j=d.width}if(d.expandOnlyOne){h=true}}this.initTree(f,d);this.addEvents(f,d)}else{if(g=="highlight"){e.highlight(f,d)}else{if(g=="switchto"){e.switchTo(f)}else{if(g=="getstate"){return e.getTreeState()}else{if(g=="loadstate"){e.loadTreeState(f)}else{if(g="getactive"){return e.getActiveItemId()}}}}}}return i}})})(jQuery);ITCUI_Navigation=function(renderTo,items,options){var currTabCount=0;this.handle={};this._items=items;this._options=options||{};this.MAX_TAB=options.maxTab||10;this._renderTo=renderTo;var _events={};var _this=this;var hidTabs=[];this.init=function(){_handle=this.handle;_handle.container=$(this._renderTo).addClass("bbox").html("");_handle.navigation=$("<div></div>").addClass("itcui-navigation").appendTo(_handle.container);_handle.navigation.data("obj",this);_handle.ul=$("<ul></ul>").addClass("itcui-navigation-ul").appendTo(_handle.navigation);_handle.separator=$("<div></div>").addClass("itcui-navigation-separator").appendTo(_handle.navigation);var navHtml="";for(var i=0;i<items.length;i++){var item=items[i];if(privMapping&&_ITC&&_ITC.opts){if(!privMapping[_ITC.opts.tabMapping[item.id].privilege]){continue}}navHtml+=this._makeTabHtml(item);if(item.id){_events[item.id]={};if(item.click){_events[item.id]["click"]=item.click}if(item.beforeClose){_events[item.id]["beforeClose"]=item.beforeClose}if(item.afterClose){_events[item.id]["afterClose"]=item.afterClose}if(item.beforeClick){_events[item.id]["beforeClick"]=item.beforeClick}}}navHtml+='<li class="itcui-nav-menu-btn tA0 rC0 itcui-navigation-item" style="float:left">';navHtml+="<b></b></li>";menuHtml='<div class="dropdown" style="position:absolute" id="itcui_nav_toggler_wrap">';menuHtml+='<a data-toggle="dropdown" id="itcui_nav_toggler"></a>';menuHtml+='<ul class="dropdown-menu" role="menu">';menuHtml+="</ul>";menuHtml+="</div>";_handle.ul.html(navHtml);$("body").append(menuHtml);this._bindEvent();_this.arrangeTab()};this._makeTabHtml=function(item){var tabHtml="";if(!typeof(item)=="object"||!item.name){return""}if(!item.front){item.front=""}if(item.id){tabHtml+="<li class='itcui-navigation-item tA0 oZ0' style='width:120px' id='itcui_nav_tab_"+item.id+"'>"}else{tabHtml+="<li class='itcui-navigation-item tA0 oZ0' style='width:120px'>"}tabHtml+="<span class='itcui-navigation-item-front'>"+item.front+"</span>";tabHtml+="<span class='itcui-navigation-item-name'>"+item.name+"</span>";tabHtml+="<span class='itcui-navigation-item-rear' style='display:inline'>";if(item.closeable){tabHtml+="<a class='itcui-navigation-item-close-button'><b>x</b></a>"}else{tabHtml+="<a class='itcui-navigation-item-close-button' style='display:none'><b>x</b></a>"}tabHtml+="</span>";tabHtml+="</li>";currTabCount+=1;return tabHtml};this._bindEvent=function(){_handle=this.handle;_handle.container.find(".itcui-navigation-item").each(function(e){_this._bindSingleEvent($(this))})};this._bindSingleEvent=function(obj){obj.on("mouseenter",function(e){if(!$(this).hasClass("itcui-navigation-item-selected")){$(this).removeClass("itcui-navigation-item").addClass("itcui-navigation-item-hover")}}).on("mouseleave",function(e){if(!$(this).hasClass("itcui-navigation-item-selected")){$(this).addClass("itcui-navigation-item")}$(this).removeClass("itcui-navigation-item-hover")}).on("click",function(e){e.stopPropagation();var _this=$(this);var ptr=_this.parents(".itcui-navigation").data("obj");if(_this.attr("id")){var id=_this.attr("id").replace("itcui_nav_tab_","");ptr.activeById(id)}if(_this.hasClass("itcui-nav-menu-btn")){menuHtml='<li targettab="_all"><a class="menuitem"><i class="itcui_close_tab"></i>关闭所有选项卡</a></li>';if(hidTabs.length>0){menuHtml+='<li class="divider"></li>';for(var i=0;i<hidTabs.length;i++){menuHtml+='<li targettab="'+hidTabs[i][0]+'"><a class="menuitem"><i class="itcui_menu_icon"></i>'+hidTabs[i][1]+"</a></li>"}}$("#itcui_nav_toggler_wrap ul").html(menuHtml);$("#itcui_nav_toggler_wrap").data("ptr",ptr);$("#itcui_nav_toggler_wrap ul li").click(function(){var _this=$(this);var ptr=_this.parent().parent().data("ptr");var target=_this.attr("targettab");if(target=="_all"){ptr._closeAll()}else{ptr.activeById(target)}});var pos=_this.offset();$("#itcui_nav_toggler_wrap").css({top:pos.top+32,left:pos.left+3});$("#itcui_nav_toggler").dropdown("toggle")}});obj.find(".itcui-navigation-item-close-button").on("click",function(e){e.stopPropagation()}).on("mouseover",function(e){$(this).addClass("itcui-navigation-item-close-button-hover")}).on("mouseleave",function(e){$(this).removeClass("itcui-navigation-item-close-button-hover")}).on("click",function(e){var _this=$(this);var id=_this.parent().parent().attr("id").replace("itcui_nav_tab_","");var ptr=_this.parents(".itcui-navigation");ptr.data("obj").removeById(id)})};this.insert=function(item,options){options=options||{};var position=options.position||"last";if(!item){return}var tabHtml=this._makeTabHtml(item);if(item.id){_events[item.id]={};if(item.click){_events[item.id]["click"]=item.click}if(item.beforeClose){_events[item.id]["beforeClose"]=item.beforeClose}if(item.afterClose){_events[item.id]["afterClose"]=item.afterClose}if(item.beforeClick){_events[item.id]["beforeClick"]=item.beforeClick}}if(position=="first"){_handle.ul.prepend(tabHtml);_this._bindSingleEvent(_handle.ul.find(".itcui-navigation-item").first())}else{if(position=="last"){_this._bindSingleEvent(_handle.ul.children(".itcui-nav-menu-btn").before(tabHtml).prev(".itcui-navigation-item"))}else{if(/before/.test(position)){var targetid="#itcui_nav_tab_"+position.replace("before:","");_this._bindSingleEvent(_handle.ul.find(targetid).before(tabHtml).prev(".itcui-navigation-item"))}else{if(/after/.test(position)){var targetid="#itcui_nav_tab_"+position.replace("after:","");_this._bindSingleEvent(_handle.ul.find(targetid).after(tabHtml).next(".itcui-navigation-item"))}}}}_this.arrangeTab()};this.arrangeTab=function(){if(currTabCount<=_this.MAX_TAB){_handle.ul.find(".itcui-navigation-item").first().css("margin-left","0px");return}var firstTab=_handle.ul.find(".itcui-nav-menu-btn");var flag=true;var findCnt=0;var findOneMore=false;hidTabs=[];while(flag){firstTab=firstTab.prev("li");if(firstTab.length>0){findCnt++;if(findCnt<_this.MAX_TAB){if(firstTab.css("display")=="none"){firstTab.css({display:"block"}).addClass("itcui-navigation-item")}if(firstTab.hasClass("itcui-navigation-item-selected")){findOneMore=true}}else{if(findOneMore){if(firstTab.css("display")=="none"){firstTab.css({display:"block"}).addClass("itcui-navigation-item")}findOneMore=false}else{if(!firstTab.hasClass("itcui-navigation-item-selected")){firstTab.css("display","none").removeClass("itcui-navigation-item");hidTabs.push([firstTab.attr("id").replace("itcui_nav_tab_",""),firstTab.children(".itcui-navigation-item-name").html()])}else{firstTab.addClass("itcui-navigation-item").css("display","inline-block")}}}}else{flag=false}firstTab.css("margin-left","-1px")}_handle.ul.find(".itcui-navigation-item").first().css("margin-left","0px")};this.activeById=function(id){var tabId="#itcui_nav_tab_"+id;if(!this._run(_events[id]["beforeClick"],id)){return}var _this=$(this._renderTo).find(tabId);if(_this.length==0){return false}if(_this.hasClass("itcui-nav-menu-btn")){return}_this.parent().find("li").removeClass("itcui-navigation-item-selected");_this.addClass("itcui-navigation-item-selected").addClass("itcui-navigation-item");if(_event_handler){_event_handler.triggerEvent("tabSwitch",id)}var fun2=_events[id]["click"];if(fun2){this._run(fun2,id)}if(hidTabs.length>0){this.arrangeTab()}return true};this._run=function(fun,arg){if(!fun){return true}if(typeof(fun)=="string"){eval(fun);return true}else{return fun(arg)}};this.removeById=function(id){if(!this._run(_events[id].beforeClose,id)){return}var tabId="#itcui_nav_tab_"+id;var needActive=_handle.ul.find(tabId).hasClass("itcui-navigation-item-selected");_handle.ul.find(tabId).remove();currTabCount-=1;this._run(_events[id].afterClose,id)};this.updateById=function(item){if(!item||!item.id){return}var tabId="#itcui_nav_tab_"+item.id;if(item.name){_handle.ul.find(tabId).find(".itcui-navigation-item-name").html(item.name)}};this.getCurrentTab=function(){return _handle.ul.children(".itcui-navigation-item-selected").attr("id").replace("itcui_nav_tab_","")};this._closeAll=function(){_handle.ul.children("li").each(function(){var closeBtn=$(this).find(".itcui-navigation-item-close-button");if(closeBtn.length>0&&closeBtn.css("display")!="none"){var id=$(this).attr("id").replace("itcui_nav_tab_","");_this.removeById(id)}})}};function _itc_initskinner(){if($("#itc_skin").length>0){return}var a='<footer class="skin"><div class="skin-item skin-top">    <div class="skin-top-inner"></div>    <div class="skin-top-inner2"></div></div><div class="skin-item skin-top-left"></div><div class="skin-item skin-top-right"></div><div class="skin-item skin-left" id="themeLeft"></div><div class="skin-item skin-left-top" id="themeLeftTop"></div><div class="skin-item skin-left-bottom" id="themeLeftBottom"></div><div class="skin-item skin-right"></div><div class="skin-item skin-right-top"></div><div class="skin-item skin-right-bottom"></div><div class="skin-item skin-bottom"></div><div class="skin-item skin-fullScreen" id="themeFullScreen"></div><div class="skin-imgProxy" id="themeImgProxy"></div></footer>';$("body").prepend(a)}function _itc_initskinlist(){}function _itc_selectskin(){};